<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>AI Vulnerability Detector</title>
<style>
:root{--bg:#0f1724;--card:#0b1220;--accent:#7c3aed;--muted:#94a3b8;--success:#10b981;--danger:#ef4444}
html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial;background:linear-gradient(180deg,#071025 0%, #041024 100%);color:#e6eef8}
.container{max-width:1100px;margin:32px auto;padding:24px}
header{display:flex;align-items:center;gap:16px}
header h1{margin:0;font-size:20px}
.card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;padding:18px;box-shadow:0 6px 18px rgba(2,6,23,0.6);}
.grid{display:grid;grid-template-columns:1fr 420px;gap:18px;margin-top:18px}
textarea{width:100%;height:380px;background:transparent;border:1px solid rgba(255,255,255,0.06);color:inherit;padding:12px;border-radius:8px;font-family:monospace;font-size:13px;resize:vertical}
.controls{display:flex;gap:8px;flex-wrap:wrap}
select,input[type=file]{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:8px;border-radius:8px;color:inherit}
button{background:var(--accent);border:0;padding:10px 14px;border-radius:10px;color:white;font-weight:600;cursor:pointer}
button.secondary{background:transparent;border:1px solid rgba(255,255,255,0.06)}
.results{margin-top:12px;max-height:380px;overflow:auto}
.finding{border-left:4px solid rgba(255,255,255,0.04);padding:12px;margin-bottom:10px;border-radius:8px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent)}
.sev-high{border-left-color:var(--danger)}
.sev-med{border-left-color:#f59e0b}
.sev-low{border-left-color:var(--success)}
.tag{display:inline-block;padding:4px 8px;border-radius:999px;background:rgba(255,255,255,0.03);font-weight:600;margin-right:8px}
footer{margin-top:18px;color:var(--muted);font-size:13px}
.small{font-size:13px;color:var(--muted)}
.hint{background:rgba(255,255,255,0.02);padding:10px;border-radius:8px;margin-top:10px}
@media (max-width:980px){.grid{grid-template-columns:1fr;}.container{padding:12px}}
</style>
</head>
<body>
<div class="container">
<header>
  <div class="card" style="display:flex;align-items:center;gap:12px;padding:12px 16px">
    <svg width="36" height="36" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="20" height="20" rx="6" fill="#0ea5a4" opacity="0.12"/>
      <path d="M7 12h10M7 8h10M7 16h6" stroke="#06b6d4" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
    <div>
      <h1>AI Vulnerability Detector </h1>
      <div class="small">Paste code or upload files, press <strong>Analyze</strong>. Includes local heuristics + AI-integration hooks.</div>
    </div>
  </div>
</header>

<div class="grid">
  <div class="card">
    <div style="display:flex;gap:10px;align-items:center;justify-content:space-between">
      <div style="display:flex;gap:8px;align-items:center">
        <div class="small">Language: 
          <select id="langSelect">
            <option value="auto">Auto-detect</option>
            <option>javascript</option>
            <option>python</option>
            <option>java</option>
            <option>php</option>
            <option>c</option>
          </select>
        </div>
      </div>
      <div class="controls">
        <input id="fileInput" type="file" accept=".js,.py,.java,.php,.c,.cpp,.txt,.json,.html"/>
        <button id="analyzeBtn">Analyze</button>
        <button id="clearBtn" class="secondary">Clear</button>
        <button id="downloadHtmlBtn" class="secondary">Download HTML Report</button>
      </div>
    </div>

    <div style="margin-top:12px">
      <textarea id="codeArea">// Example code to test vulnerabilities</textarea>
    </div>

    <div class="hint">
      <strong>How this demo works:</strong>
Code is analyzed in two layers:

Static Heuristic Scanner – Local pattern-based checks quickly flag common issues such as XSS, SQL injection, command injection, unsafe eval, hard-coded secrets, and insecure transport usage.

AI-Powered Analysis – After heuristics, the code is passed to an integrated AI model for deeper contextual review. The AI not only confirms potential vulnerabilities but also provides remediation suggestions and safer code alternatives tailored to the detected issues.

This combined approach balances speed (local scanning) and accuracy (AI-powered triage), making the tool suitable for both quick checks and deeper vulnerability assessment.
    </div>
  </div>

  <aside class="card">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <div>
        <div class="small">Findings</div>
        <div style="font-weight:700">Analysis Report</div>
      </div>
    </div>

    <div class="results" id="results">
      <div class="small">No run yet — paste code and click Analyze.</div>
    </div>

    <div style="margin-top:12px">
      <div class="small">Quick checks performed:</div>
      <ul class="small" style="margin-top:6px;margin-bottom:0;">
        <li>Unsanitized user input used in SQL/OS/HTML contexts</li>
        <li>Use of eval(), innerHTML, document.write()</li>
        <li>Hard-coded API keys, passwords</li>
        <li>Unsafe deserialization patterns</li>
        <li>Command execution functions (system, exec, popen)</li>
      </ul>
    </div>
  </aside>
</div>

<footer class="card" style="margin-top:18px">
  <div class="small">Note: This is a frontend demo. For reliable security scanning integrate a backend with static analysis + AI.</div>
</footer>
</div>

<script>
// Patterns
const patterns = [
  {id:'xss', name:'Possible XSS', re:/innerHTML|document\.write|write\(|insertAdjacentHTML/i, severity:'high', fix:'Escape or sanitize user input before inserting into DOM.'},
  {id:'eval', name:'Use of eval()/Function()', re:/\b(eval|new Function)\s*\(/i, severity:'high', fix:'Avoid eval.'},
  {id:'sql', name:'Possible SQL injection', re:/(SELECT|INSERT|UPDATE|DELETE).+\+\s*.*(req\.|request\.)/i, severity:'high', fix:'Use parameterized queries.'},
  {id:'cmd', name:'Possible command injection', re:/\b(exec|system|popen|shell_exec|Runtime\.getRuntime\(|ProcessBuilder)\b/i, severity:'high', fix:'Avoid passing user input to shell.'},
  {id:'secret', name:'Hard-coded secrets', re:/(api[_-]?key|secret|password)\s*[:=]\s*["']?[A-Za-z0-9\-_=]{8,}["']?/i, severity:'medium', fix:'Store secrets in environment variables.'},
  {id:'http', name:'Use of HTTP', re:/http:\/\/[^\s'"`]+/i, severity:'low', fix:'Prefer HTTPS.'}
];

// Detect
function detectIssues(code){
  const findings = [];
  for(const p of patterns){
    const matches = code.match(new RegExp(p.re.source,'gmi'));
    if(matches){
      for(const m of matches){
        findings.push({id:p.id, title:p.name, snippet:m, severity:p.severity, fix:p.fix});
      }
    }
  }
  return findings;
}

// Render on-page analysis
function renderFindings(list){
  const container = document.getElementById('results');
  container.innerHTML='';
  if(list.length===0){
    container.innerHTML='<div class="small">No obvious findings.</div>'; return;
  }
  list.forEach(f=>{
    const div=document.createElement('div');
    div.className='finding '+(f.severity==='high'?'sev-high':f.severity==='medium'?'sev-med':'sev-low');
    div.innerHTML=`<div style="display:flex;justify-content:space-between;align-items:center">
      <div style="font-weight:700">${escapeHtml(f.title)}</div>
      <div class="small">Severity: ${escapeHtml(f.severity.toUpperCase())}</div>
    </div>
    <pre style="white-space:pre-wrap;margin:8px 0;padding:8px;border-radius:6px;background:rgba(255,255,255,0.01);font-size:12px">${escapeHtml(f.snippet)}</pre>
    <div style="font-size:13px;color:var(--muted)"><strong>Suggested fix:</strong> ${escapeHtml(f.fix)}</div>`;
    container.appendChild(div);
  });
}

// Escape HTML
function escapeHtml(s){return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}

// Events
document.getElementById('analyzeBtn').addEventListener('click',()=>{
  const code=document.getElementById('codeArea').value;
  const findings=detectIssues(code);
  renderFindings(findings);
  window.__lastReport={meta:{timestamp:(new Date()).toISOString(),language:document.getElementById('langSelect').value,total:findings.length},findings};
});

document.getElementById('clearBtn').addEventListener('click',()=>{
  document.getElementById('codeArea').value='';
  document.getElementById('results').innerHTML='<div class="small">Cleared.</div>';
  window.__lastReport=null;
});

document.getElementById('fileInput').addEventListener('change',async e=>{
  const f=e.target.files[0]; if(!f) return;
  document.getElementById('codeArea').value=await f.text();
});

// Download HTML report in table format
document.getElementById('downloadHtmlBtn').addEventListener('click',()=>{
  if(!window.__lastReport) return alert("Run analysis first");
  const r=window.__lastReport;
  const rows=r.findings.map(f=>`
  <tr>
    <td>${escapeHtml(f.title)}</td>
    <td class="sev-${f.severity==='high'?'high':f.severity==='medium'?'med':'low'}">${escapeHtml(f.severity.toUpperCase())}</td>
    <td><pre>${escapeHtml(f.snippet)}</pre></td>
    <td>${escapeHtml(f.fix)}</td>
  </tr>`).join('');
  const html=`<!doctype html>
  <html>
  <head>
  <meta charset="utf-8">
  <title>AI Vulnerability Report</title>
  <style>
    body{font-family:Arial,sans-serif;background:#0f1724;color:#e6eef8;padding:20px;}
    h1{margin-bottom:12px;}
    table{width:100%;border-collapse:collapse;}
    th,td{border:1px solid rgba(255,255,255,0.06);padding:8px;vertical-align:top;font-size:13px;}
    th{background:rgba(255,255,255,0.05);text-align:left;}
    .sev-high{color:#ffb3b3;font-weight:700;}
    .sev-med{color:#f59e0b;font-weight:700;}
    .sev-low{color:#10b981;font-weight:700;}
    pre{white-space:pre-wrap;margin:0;font-size:12px;background:rgba(255,255,255,0.02);padding:6px;border-radius:4px;}
  </style>
  </head>
  <body>
  <h1>AI Vulnerability Report</h1>
  <div><strong>Generated:</strong> ${r.meta.timestamp}<br>
       <strong>Language:</strong> ${r.meta.language}<br>
       <strong>Total Findings:</strong> ${r.meta.total}</div>
  <table>
    <thead>
      <tr>
        <th>Detector</th>
        <th>Severity</th>
        <th>Snippet</th>
        <th>Suggested Fix</th>
      </tr>
    </thead>
    <tbody>${rows}</tbody>
  </table>
  </body>
  </html>`;
  const blob=new Blob([html],{type:'text/html'});
  const url=URL.createObjectURL(blob);
  const a=document.createElement('a');
  a.href=url;
  a.download='vulnerability_report.html';
  a.click();
  URL.revokeObjectURL(url);
});
</script>
</body>
</html>